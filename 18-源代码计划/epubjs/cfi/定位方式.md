<!--
 * @Description: 
 * @Author: xlm
 * @Date: 2023-03-10 15:12:45
 * @LastEditTime: 2023-03-10 15:41:43
 * @LastEditors: xlm
-->


# cfi可快速直接跳转, 百分比需要先完成位置信息的计算

```js


 _display (target) {
    if (!this.book) {
      return;
    }
    var isCfiString = this.epubcfi.isCfiString(target);
    var displaying = new defer();
    var displayed = displaying.promise;
    var section;
    var moveTo;

    this.displaying = displaying;

    // Check if this is a book percentage
    if (this.book.locations.length() && isFloat(target)) {
      target = this.book.locations.cfiFromPercentage(parseFloat(target));
    }
  }


// 电子书导航信息加载完成之后执行回调函数
book.loaded.navigation.then(nav => {
  console.log("初始化目录");
  navigation = nav.toc;
  book.ready.then(() => {
    console.log("book.ready");
    // 执行分页
    return book.locations.generate()
  }).then(result => {
    // 获取Locations对象
    locations = book.locations;
    // 获得当前页信息
    const startLoc = locations.cfiFromPercentage(currProgress.value/100);
    rendition.display(startLoc);
    bookLoading.close();
  }).catch(()=>{
    })
})

```




```js
/**
	 * Get a location from an EpubCFI
	 * @param {EpubCFI} cfi
	 * @return {number}
	 */
	locationFromCfi(cfi){
		let loc;
		if (EpubCFI.prototype.isCfiString(cfi)) {
			cfi = new EpubCFI(cfi);
		}
		// Check if the location has not been set yet
		if(this._locations.length === 0) {
			return -1;
		}

		loc = locationOf(cfi, this._locations, this.epubcfi.compare);

		if (loc > this.total) {
			return this.total;
		}

		return loc;
	}

	/**
	 * Get a percentage position in locations from an EpubCFI
	 * @param {EpubCFI} cfi
	 * @return {number}
	 */
	percentageFromCfi(cfi) {
		if(this._locations.length === 0) {
			return null;
		}
		// Find closest cfi
		var loc = this.locationFromCfi(cfi);
		// Get percentage in total
		return this.percentageFromLocation(loc);
	}

```    